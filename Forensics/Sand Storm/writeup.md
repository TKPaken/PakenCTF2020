# 問題

（ファイルが与えられる）

# 解説

このアナログテレビの砂嵐のような画像は **Vernam暗号** で暗号化されています。

Vernam暗号とは、平文と同じ長さの乱数＝鍵を用意しビットごとにそれと平文の排他的論理和をとることで暗号化する暗号方式です。

復号する際には同じように暗号文と鍵のビットごとの排他的論理和をとります。

この画像では、ヘッダを暗号化せずデータ部分のみ暗号化しているため、暗号化後もBMPファイルとして開くことができます。

BMP画像は基本的に14バイトのファイルヘッダ、40バイトの情報ヘッダ、色ビット数×4バイトのパレットデータ、画像データから成り立っています。

色ビット数は、情報ヘッダからモノクロ２ビットBMPであることがわかるため、パレットデータは8バイトです。

つまり、画像のデータは63バイト目から始まっています。また、鍵ファイルもBMPファイルより62ビット小さいです。

この画像を復号するには、1バイト目から62バイト目まではそのままflat.bmpのデータを、

それ以降はiバイト目をflat.bmpのiバイト目とkeyのi-62バイト目の

排他的論理和をファイルに書き込んで出力するプログラムを作成します。

すると、出力された画像にFlagが書かれています。

これで、```Flag：pakenCTF{C16uDe_31w00D_5hann0n}``` を得ることができました。
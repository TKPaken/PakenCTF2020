# 問題

（ファイルが与えられる）

# 解説

これは典型的な暗号アルゴリズム **「Elgamal暗号」** に関する問題です。

ファイル「pyc」と二つの暗号文が与えられます。

「pyc」はPythonのバイトコードで、基本的にソースコードのままよりも実行が速いです。

また、そのままでは我々にとって可読性が極めて低いですが逆コンパイルすることで元のソースコードを入手することができます。

そうすると暗号化のプログラムを得られるので復号も容易に行うことができます。


逆コンパイルはLinux上で行います。

まず、 **"pip install uncompyle"** でモジュールを入手します。

次に、「pyc」を「data.pyc」などにし

**"uncompyle6 data.pyc"** を実行します。

するとソースコードを入手します。

Elgamal暗号の定義は

p:素数、g,x,r:整数、m:平文、y:g^x%pとして

**Enc(m)=(g^r%p,y^r%p)**

**Dec(c1,c2)=c2*(c1^x)^-1%p**

であるので、これに従って復号プログラムを作成します。

必要な情報は全て入手したソースコードにあるため容易に復号できます。

そして復号して得た整数を16進数で表し２文字ごとにASCIIコードとして文字と置き換えます。

そうすることで ```Flag：pakenCTF{7a6er_4_31GaMa1}``` を得ることができました。

writer:kenkenken2004
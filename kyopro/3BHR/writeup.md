# 問題

時は2050年。自治会によって奪われた自由を取り戻すべく、我々筑駒革命軍は自治会率いる筑駒防衛軍に宣戦布告した。

決闘の場所は筑駒のグラウンドである。

グラウンドは南北にHm、東西にWmの長方形である。ここで、北西の端からx m南に、y m東に行った点を(x,y) と表現することにしよう。

グラウンドにはN人の防衛軍がおり、i 人目は(X_i,Y_i) に立っている。いずれも南北両方向または東西両方向に向かってビームを撃っており、南北方向ならp_i=0, 東西方向なら p_i=1 である。

我々は任意の回数だけ防衛軍の射程圏外の任意の場所に移動、東西または南北にビームを撃ってその方向にいる防衛軍を倒す事ができる。なお、グラウンドの外から撃つこともできるが、防衛軍のビームはグラウンド外にも貫通することに注意だ。

さて、最大で何人の防衛軍を倒す事ができるだろうか？

入力フォーマット

```
H W N
X_1 Y_1 p_1
...
X_N Y_N p_N
```

制約

- H,Wは10^9以下
- Nは10^5以下
- 0<=X_i < H
- 0<=Y_i < W

入力例1
```
5 5 2
1 1 1
1 3 0
```

出力例1
```
2
```

入力例2
```
5 5 4
1 1 1
1 3 0
3 3 1
3 1 0
```

出力例2
```
0
```

この問題の [入力1](./test1.txt) , [入力2](./test2.txt) についての正しい出力をそれぞれAns1,Ans2とすればFlagは ```pakenCTF{Ans1_Ans2}``` です。

# 解説

3BHRというのは、3BHRの映画リスペクトで問題を作成したからです...というのは嘘で、実は以前に制約が小さいバージョンを筑駒入試コンテストで出題した事があります。本題に移りましょう。

この設定の場合、Xを撃つためにはYを撃つ必要があり...といった依存関係が存在します。例えば、Xが(0,0)にいて東西方向に、Yが(1,0)にいて南北方向に撃っていたとします。この場合、東西方向にビームを撃っているXを撃つためには南北方向から撃つ必要がありますが、こちらはYがビームを撃っています。

よって、この依存関係は有向グラフに落としこむ事ができます。入次数が0の所から倒して行けばいいのですが、閉路になっていたりすると1人も倒せません。

さて、このままだとグラフの頂点は人になり構築にO(N^2)かかってしまいますが、頂点をX,Y座標にして考えると上手く行きます。座標圧縮するのを忘れないようにして下さい。

合計で計算量は座標圧縮がボトルネックでO(N log N)となり、高速に解く事ができました。なお、こちらのミスによりNが10^5程度のため時間をかければO(N^2)でも解く事ができます。

[solve code](./solve.cpp)

FLAG : ```pakenCTF{55157_80517}```

writer : define